# Frontend Project - Setup Archives

## Project Setup and Configuration

*Added on: 2023-07-23 14:30:45*

The frontend project is a React application built with TypeScript, using Next.js as the framework.

### Environment Setup

1. Node.js version: 18.x or higher
2. Package manager: pnpm (v8.6.0 or higher)
3. Next.js version: 14.0.1

### Getting Started

Clone the repository and install dependencies:

```bash
git clone https://github.com/example/frontend.git
cd frontend
pnpm install
```

Run the development server:

```bash
pnpm dev
```

The application will be available at `http://localhost:3000`.

### Project Structure

```
frontend/
├── app/              # Next.js app directory (App Router)
├── components/       # React components
│   ├── ui/           # Reusable UI components
│   └── features/     # Feature-specific components
├── lib/              # Utility functions and libraries
├── styles/           # Global styles
├── public/           # Static assets
└── tests/            # Test files
```

### Key Configuration Files

- `next.config.js`: Next.js configuration
- `tsconfig.json`: TypeScript configuration
- `tailwind.config.js`: Tailwind CSS configuration
- `.eslintrc.json`: ESLint configuration
- `.env.local`: Local environment variables (not checked into git)

### API Integration

The frontend connects to the backend API using a custom API client located at `lib/api.ts`. The base URL is configured using the `NEXT_PUBLIC_API_URL` environment variable.

### Deployment

The project is deployed using Vercel. The `main` branch is automatically deployed to production, while feature branches are deployed to preview environments.

---

## Authentication System Implementation

*Added on: 2023-07-24 09:15:22*

We implemented JWT-based authentication for the frontend application.

### Authentication Flow

1. User submits login credentials on the `/login` page
2. Frontend sends credentials to `POST /api/auth/login` endpoint
3. Backend validates credentials and returns JWT token
4. Frontend stores token in HTTP-only cookie (implemented using next-auth)
5. Authenticated requests include the cookie automatically
6. Protected routes check for valid authentication using middleware

### Implementation Details

Authentication is implemented using NextAuth.js with a custom JWT provider. The configuration is in `app/api/auth/[...nextauth]/route.ts`.

Key components:
- `components/auth/LoginForm.tsx`: Login form component
- `components/auth/RegisterForm.tsx`: Registration form component
- `middleware.ts`: NextAuth middleware for protected routes
- `lib/auth.ts`: Authentication utility functions

### Protected Routes

Protected routes are defined in the middleware configuration. Currently, all routes under `/dashboard/*` require authentication.

### Credentials Storage

- JWT token is stored in an HTTP-only cookie
- Refresh token mechanism is implemented to handle token expiration
- Token expiration is set to 1 hour, refresh tokens to 7 days

---

## Error Encountered: Next.js API Routes Not Working in Production

*Added on: 2023-07-25 13:45:10*

We encountered an issue where the Next.js API routes worked locally but failed in production.

### Issue Description

API routes returned 404 errors in production environment on Vercel despite working correctly in local development environment.

### Troubleshooting Steps

1. Checked Vercel deployment logs - no build errors
2. Verified API routes were following correct Next.js pattern
3. Tested with different browsers and devices
4. Compared local and production environment variables

### Root Cause

The issue was related to a misconfiguration in the Next.js config file. We were using the `output: 'export'` option, which disables API routes in Next.js.

### Fix Applied

Removed the `output: 'export'` option from `next.config.js`:

```js
// Before
const nextConfig = {
  reactStrictMode: true,
  output: 'export', // This was causing the issue
  // other config...
};

// After
const nextConfig = {
  reactStrictMode: true,
  // other config...
};
```

The API routes started working correctly in production after this change.

--- 